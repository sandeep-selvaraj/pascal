[changelog]
header = """
# Changelog

All notable changes to pascal are documented here.

Format follows [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).
Commits follow the [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) spec.\n
"""
body = """
{% if version %}\
    ## [{{ version | trim_start_matches(pat="v") }}] — {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}\
    ## [Unreleased]
{% endif %}\
{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | upper_first }}
    {% for commit in commits %}
        - {% if commit.breaking %}[**breaking**] {% endif %}\
          {{ commit.message | upper_first }} ([`{{ commit.id | truncate(length=7, end="") }}`]({{ commit.id }}))\
    {% endfor %}
{% endfor %}\n
"""
trim = true
footer = ""

[git]
conventional_commits = true
filter_unconventional = true
split_commits = false

commit_parsers = [
  { message = "^feat",     group = "Features"        },
  { message = "^fix",      group = "Bug Fixes"        },
  { message = "^perf",     group = "Performance"      },
  { message = "^refactor", group = "Refactoring"      },
  { message = "^docs",     group = "Documentation"    },
  { message = "^test",     group = "Tests"            },
  { message = "^ci",       group = "CI"               },
  { message = "^chore",    group = "Miscellaneous"    },
  { message = "^revert",   group = "Reverts"          },
  # Ignore changelog update commits themselves
  { message = "^chore: update CHANGELOG", skip = true },
]

# Only include commits that touch the package (ignore pure-docs or CI tweaks
# from appearing in the release body — they still appear in CHANGELOG.md)
protect_breaking_commits = true
filter_commits = false
tag_pattern = "v[0-9].*"
skip_tags = ""
ignore_tags = "rc|alpha|beta"
topo_order = false
sort_commits = "newest"
